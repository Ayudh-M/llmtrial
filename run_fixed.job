#!/bin/bash
#SBATCH -J llm_fixed
#SBATCH -A tesr108469
#SBATCH -p gpu_h100
#SBATCH -t 00:20:00
#SBATCH --gpus=1
#SBATCH --cpus-per-task=8
#SBATCH --mem=40G
#SBATCH -o logs/%x-%j.out

set -euo pipefail
module purge && module load 2025
source ~/.venvs/llmtrial/bin/activate

export PYTHONUNBUFFERED=1
export PYTHONPATH=.

SCEN="Solve: A train travels 120 km in 2h and then 180 km in 3h. Return ONLY the average speed in km/h as a number."
python -m src.simple_dialog \
  --scenario "$SCEN" \
  --strategy NL \
  --roleset Planner-Solver \
  --turns 6 \
  --model-a mistralai/Mistral-7B-Instruct-v0.3 \
  --model-b mistralai/Mistral-7B-Instruct-v0.3 \
  --max-new-tokens 192 \
  --temperature 0.7 \
  --top-p 0.9 \
  --seed 42 \
  --outdir logs
